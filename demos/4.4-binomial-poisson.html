<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>4.4 Binomial &amp; Poisson</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <header>
    <h1>Unit 4: Probability and Statistical Inference</h1>
    <p class="subtitle">4.4 — Binomial and Poisson Distributions</p>
  </header>

  <main class="demo-page">
    <a href="../index.html" class="back-link">← Back to all sections</a>

    <h1>4.4: Binomial and Poisson Distributions</h1>

    <div class="concept-block">
      <h2>What You'll Learn</h2>
      <ul>
        <li><strong>Binomial:</strong> Count successes in \(n\) independent trials (each with probability \(p\))</li>
        <li><strong>Poisson:</strong> Count events in a fixed interval (rate \(\mu\) per interval)</li>
      </ul>
      <p><strong>When to use:</strong> Binomial — web feature reactions, Facebook users in sample, defect counts. Poisson — Starbucks visits, EV charging stations opening, arrivals per hour.</p>
      <p><strong>Prerequisites:</strong> <a href="4.3-discrete-rv.html">4.3</a> — discrete random variables, expected value.</p>
    </div>

    <div class="content-section">
      <h2>Binomial Distribution</h2>
      <p>A <strong>Bernoulli process</strong> has \(n\) independent trials, each with success probability \(p\). \(X\) = number of successes, \(X \in \{0,1,\ldots,n\}\).</p>
      <div class="formula">\[ P(X=x) = \binom{n}{x} p^x (1-p)^{n-x}, \quad E(X)=np, \quad \text{Var}(X)=np(1-p) \]</div>
    </div>

    <div class="content-section">
      <h2>Poisson Distribution</h2>
      <p>Counts events in a fixed interval. Conditions: (1) counts 0,1,2,…; (2) disjoint intervals independent; (3) rate proportional to interval length. \(\mu\) = mean number in interval.</p>
      <div class="formula">\[ P(X=x) = \frac{e^{-\mu} \mu^x}{x!} \]</div>
    </div>

    <div class="content-section">
      <h2>Binomial vs Poisson</h2>
      <p><strong>Binomial:</strong> \(n\) fixed trials, count successes (e.g., 5 customers react to web features). <strong>Poisson:</strong> Count events in a fixed interval—no fixed "n" (e.g., Starbucks visits in 5 days, EV stations opening per week).</p>
    </div>

    <h2>Interactive Demo: Binomial</h2>
    <div class="demo-box">
      <p><strong>Example presets:</strong> Web features (\(n=5\), \(p=0.30\)) — 30% react positively. Facebook users (\(n=100\), \(p=0.68\)).</p>
      <div class="input-row">
        <div class="input-group">
          <label>\(n\)</label>
          <input type="number" id="bn" value="5" min="1" max="50">
        </div>
        <div class="input-group">
          <label>\(p\)</label>
          <input type="number" id="bp" value="0.30" min="0" max="1" step="0.01">
        </div>
        <div class="input-group">
          <label>\(x\) (for P(X=x), P(X≤x), P(X≥x))</label>
          <input type="number" id="bx" value="2" min="0" max="50">
        </div>
      </div>
      <div class="result">
        \(E(X)\) = <span id="bMean">1.5</span>, \(\text{Var}(X)\) = <span id="bVar">1.05</span><br>
        \(P(X=x)\) = <span id="bPmfx">0.3087</span>, \(P(X \le x)\) = <span id="bCdf">0.8369</span>, \(P(X \ge x)\) = <span id="bSf">0.4718</span>
      </div>
      <canvas id="binomChart" width="500" height="220"></canvas>
    </div>

    <h2>Interactive Demo: Poisson</h2>
    <div class="demo-box">
      <p><strong>Example presets:</strong> Starbucks—18 visits/month ⇒ \(\mu=3\) in 5 days. EV charging—1.5/day ⇒ \(\mu=10.5\) per week.</p>
      <div class="input-row">
        <div class="input-group">
          <label>\(\mu\)</label>
          <input type="number" id="pmu" value="3" min="0.1" max="20" step="0.1">
        </div>
        <div class="input-group">
          <label>\(x\)</label>
          <input type="number" id="px" value="5" min="0" max="30">
        </div>
      </div>
      <div class="result">
        \(P(X=x)\) = <span id="pPmfx">0.1008</span>, \(P(X \le x)\) = <span id="pCdf">0.9161</span>
      </div>
      <canvas id="poisChart" width="500" height="220"></canvas>
    </div>
  </main>

  <footer><a href="../index.html">← Back to all sections</a></footer>

  <script src="../js/shared.js"></script>
  <script src="../js/flare.js"></script>
  <script>
    function binomPmf(n, p, x) {
      if (x < 0 || x > n) return 0;
      return binom(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);
    }
    function binomCdf(n, p, x) {
      let s = 0;
      for (let k = 0; k <= x; k++) s += binomPmf(n, p, k);
      return s;
    }
    function poisPmf(mu, x) {
      return Math.exp(-mu) * Math.pow(mu, x) / factorial(x);
    }
    function poisCdf(mu, x) {
      let s = 0;
      for (let k = 0; k <= x; k++) s += poisPmf(mu, k);
      return s;
    }

    function parseVal(id, def) { const v = parseFloat(document.getElementById(id)?.value); return isNaN(v) ? def : v; }

    function updateBinom() {
      const n = Math.floor(parseVal('bn', 5)), p = parseVal('bp', 0.3), x = parseVal('bx', 2);
      const mean = n * p, varX = n * p * (1 - p);
      const pmf = binomPmf(n, p, x), cdf = binomCdf(n, p, x), sf = 1 - binomCdf(n, p, x - 1);
      document.getElementById('bMean').textContent = mean.toFixed(1);
      document.getElementById('bVar').textContent = varX.toFixed(2);
      document.getElementById('bPmfx').textContent = pmf.toFixed(4);
      document.getElementById('bCdf').textContent = cdf.toFixed(4);
      document.getElementById('bSf').textContent = sf.toFixed(4);
      if (pmf > 0.5 && typeof showFlare === 'function') {
        showFlare('WHAM', document.getElementById('binomChart'), { size: 'small', key: 'binom' });
      }
      const data = [];
      for (let k = 0; k <= n; k++) data.push(binomPmf(n, p, k));
      if (window.binomChart) { window.binomChart.data.datasets[0].data = data; window.binomChart.data.labels = Array.from({length: n+1}, (_,i)=>i); window.binomChart.update(); }
    }

    function updatePois() {
      const mu = parseVal('pmu', 3), x = parseVal('px', 5);
      const maxX = Math.min(30, Math.ceil(mu + 4 * Math.sqrt(mu)));
      const pmf = poisPmf(mu, x), cdf = poisCdf(mu, x);
      document.getElementById('pPmfx').textContent = pmf.toFixed(4);
      document.getElementById('pCdf').textContent = cdf.toFixed(4);
      const data = [], labels = [];
      for (let k = 0; k <= maxX; k++) { data.push(poisPmf(mu, k)); labels.push(k); }
      if (window.poisChart) { window.poisChart.data.datasets[0].data = data; window.poisChart.data.labels = labels; window.poisChart.update(); }
    }

    document.addEventListener('DOMContentLoaded', function() {
      window.binomChart = new Chart(document.getElementById('binomChart').getContext('2d'), {
        type: 'bar', data: { labels: [], datasets: [{ label: 'P(X=x)', data: [], backgroundColor: 'rgba(245,213,71,0.7)' }] },
        options: { scales: { y: { beginAtZero: true } }, plugins: { legend: { display: false } } }
      });
      window.poisChart = new Chart(document.getElementById('poisChart').getContext('2d'), {
        type: 'bar', data: { labels: [], datasets: [{ label: 'P(X=x)', data: [], backgroundColor: 'rgba(196,181,253,0.7)' }] },
        options: { scales: { y: { beginAtZero: true } }, plugins: { legend: { display: false } } }
      });
      updateBinom(); updatePois();
    });
    ['bn','bp','bx'].forEach(id => document.getElementById(id).addEventListener('input', updateBinom));
    ['pmu','px'].forEach(id => document.getElementById(id).addEventListener('input', updatePois));
  </script>
</body>
</html>
